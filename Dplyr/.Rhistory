addCircleMarkers(~destination_longitude, ~destination_latitude, radius = 5,
color = "red", fillOpacity = 0.5, label = ~paste("Destination:",
destination_ip)) %>%
addPolylines(~c(source_longitude, destination_longitude), ~c(source_latitude,
destination_latitude),
color = "green", weight = 2, opacity = 0.7) %>%
addLegend("bottomright", colors = c("blue", "red", "green"),
labels = c("Source IP", "Destination IP", "Traffic Path"),
title = "Legend") %>%
setView(lng = mean(traffic_data$source_longitude),
lat = mean(traffic_data$source_latitude), zoom = 1)
# View the first few rows of the dataset
head(data)
library(dplyr)
library(ggplot2)
library(lubridate)
install.packages("lubridate")
library(lubridate)
# Set seed for reproducibility
set.seed(123)
# Create the dataset
n <- 1000
data <- data.frame(
Timestamp = seq(from = as.POSIXct("2023-01-01 00:00"), by = "hour", length.out = n),
TotalTraffic = runif(n, min = 50, max = 500),
VoiceTraffic = runif(n, min = 10, max = 100),
VideoTraffic = runif(n, min = 20, max = 200),
DataTraffic = runif(n, min = 20, max = 200),
PeakTraffic = sample(c(0, 1), n, replace = TRUE, prob = c(0.8, 0.2)),
QoS = runif(n, min = 80, max = 100)
)
# View the first few rows of the dataset
head(data)
ggplot(data, aes(x = Timestamp, y = TotalTraffic)) +
geom_line(color = "blue") +
labs(title = "Total Network Traffic Over Time",
x = "Time",
y = "Total Traffic (Mbps)") +
theme_minimal()
ggplot(data, aes(x = Timestamp, y = TotalTraffic)) +
geom_line(color = "blue") +
labs(title = "Total Network Traffic Over Time",
x = "Time",
y = "Total Traffic (Mbps)") +
theme_minimal()
library(ggplot2)
ggplot(data, aes(x = Timestamp, y = TotalTraffic)) +
geom_line(color = "blue") +
labs(title = "Total Network Traffic Over Time",
x = "Time",
y = "Total Traffic (Mbps)") +
theme_minimal()
data_long <- data %>%
select(Timestamp, VoiceTraffic, VideoTraffic, DataTraffic) %>%
pivot_longer(cols = -Timestamp, names_to = "TrafficType", values_to = "Traffic")
data_long <- data %>%
select(Timestamp, VoiceTraffic, VideoTraffic, DataTraffic) %>%
pivot_longer(cols = -Timestamp, names_to = "TrafficType", values_to = "Traffic")
ggplot(data, aes(x = Timestamp, y = TotalTraffic)) +
geom_line(color = "blue") +
labs(title = "Total Network Traffic Over Time",
x = "Time",
y = "Total Traffic (Mbps)") +
theme_minimal()
data_long <- data %>%
select(Timestamp, VoiceTraffic, VideoTraffic, DataTraffic) %>%
pivot_longer(cols = -Timestamp, names_to = "TrafficType", values_to = "Traffic")
data_long <- data %>%
select(Timestamp, VoiceTraffic, VideoTraffic, DataTraffic) %>%
pivot_longer(cols = -Timestamp, names_to = "TrafficType", values_to = "Traffic")
ggplot(data_long, aes(x = Timestamp, y = Traffic, fill = TrafficType)) +
geom_area(alpha = 0.6 , size = 0.5, colour = "white") +
labs(title = "Traffic Composition Over Time",
x = "Time",
y = "Traffic (Mbps)",
fill = "Traffic Type") +
theme_minimal()
n <- 1000
data <- data.frame(
Timestamp = seq(from = as.POSIXct("2023-01-01 00:00"), by = "hour", length.out = n),
TotalTraffic = runif(n, min = 50, max = 500),
VoiceTraffic = runif(n, min = 10, max = 100),
VideoTraffic = runif(n, min = 20, max = 200),
DataTraffic = runif(n, min = 20, max = 200),
PeakTraffic = sample(c(0, 1), n, replace = TRUE, prob = c(0.8, 0.2)),
QoS = runif(n, min = 80, max = 100)
)
data_long <- data %>%
select(Timestamp, VoiceTraffic, VideoTraffic, DataTraffic) %>%
pivot_longer(cols = -Timestamp, names_to = "TrafficType", values_to = "Traffic")
# Summarize data by Traffic Type
traffic_summary <- data_long %>%
group_by(TrafficType) %>%
summarise(TotalTraffic = sum(Traffic))
traffic_summary <- data_long %>%
group_by(TrafficType) %>%
summarise(TotalTraffic = sum(Traffic))
install.packages("dplyr")
install.packages("ggplot2")
install.packages("lubridate")
library(dplyr)
library(ggplot2)
library(lubridate)
set.seed(123)
n <- 1000
data <- data.frame(
Timestamp = seq(from = as.POSIXct("2023-01-01 00:00"), by = "hour", length.out = n),
TotalTraffic = runif(n, min = 50, max = 500),
VoiceTraffic = runif(n, min = 10, max = 100),
VideoTraffic = runif(n, min = 20, max = 200),
DataTraffic = runif(n, min = 20, max = 200),
PeakTraffic = sample(c(0, 1), n, replace = TRUE, prob = c(0.8, 0.2)),
QoS = runif(n, min = 80, max = 100)
)
head(data)
ggplot(data, aes(x = Timestamp, y = TotalTraffic)) +
geom_line(color = "blue") +
labs(title = "Total Network Traffic Over Time",
x = "Time",
y = "Total Traffic (Mbps)") +
theme_minimal()
data_long <- data %>%
select(Timestamp, VoiceTraffic, VideoTraffic, DataTraffic) %>%
pivot_longer(cols = -Timestamp, names_to = "TrafficType", values_to = "Traffic")
data_long <- data %>%
select(Timestamp, VoiceTraffic, VideoTraffic, DataTraffic) %>%
pivot_longer(cols = -Timestamp, names_to = "TrafficType", values_to = "Traffic")
data_long <- data %>%
select(Timestamp, VoiceTraffic, VideoTraffic, DataTraffic) %>%
pivot_longer(cols = -Timestamp, names_to = "TrafficType", values_to = "Traffic")
data_long <- data %>%
select(Timestamp, VoiceTraffic, VideoTraffic, DataTraffic) %>%
pivot_longer(cols = -Timestamp, names_to = "TrafficType", values_to = "Traffic")
library(tidyverse)
install.packages("tidyverse")
library(tidyverse)
data_long <- data %>%
select(Timestamp, VoiceTraffic, VideoTraffic, DataTraffic) %>%
pivot_longer(cols = -Timestamp, names_to = "TrafficType", values_to = "Traffic")
ggplot(data_long, aes(x = Timestamp, y = Traffic, fill = TrafficType)) +
geom_area(alpha = 0.6, size = 0.5, colour = "white") +
labs(title = "Traffic Composition Over Time",
x = "Time",
y = "Traffic (Mbps)",
fill = "Traffic Type") +
theme_minimal()
# Summarize data by Traffic Type
traffic_summary <- data_long %>%
group_by(TrafficType) %>%
summarise(TotalTraffic = sum(Traffic))
# Create Donut Chart
ggplot(traffic_summary, aes(x = 2, y = TotalTraffic, fill = TrafficType)) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") +
geom_text(aes(label = paste0(round((TotalTraffic / sum(TotalTraffic)) * 100), "%")),
position = position_stack(vjust = 0.5)) +
theme_void() +
xlim(0.5, 2.5) +
labs(title = "Donut Chart of Traffic Type Distribution") +
theme(legend.position = "right")
install.packages("waterfalls")
library(waterfalls)
# Create data for Waterfall Chart
waterfall_data <- data.frame(
Step = c("Start", "Voice", "Video", "Data", "Net Change", "End"),
Value = c(0, sum(data$VoiceTraffic), sum(data$VideoTraffic), sum(data$DataTraffic),
0, sum(data$TotalTraffic))
)
# Create Waterfall Chart
waterfall(values = waterfall_data$Value, labels = waterfall_data$Step,
calc_total = TRUE) +
labs(title = "Waterfall Chart of Traffic Changes")
n <- 1000
data <- data.frame(
Timestamp = seq(from = as.POSIXct("2025-01-01 00:00"), by = "hour", length.out = n),
TotalTraffic = runif(n, min = 50, max = 500),
VoiceTraffic = runif(n, min = 10, max = 100),
VideoTraffic = runif(n, min = 20, max = 200),
DataTraffic = runif(n, min = 20, max = 200),
PeakTraffic = sample(c(0, 1), n, replace = TRUE, prob = c(0.8, 0.2)),
QoS = runif(n, min = 80, max = 100)
)
head(data)
ggplot(data, aes(x = Timestamp, y = TotalTraffic)) +
geom_line(color = "blue") +
labs(title = "Total Network Traffic Over Time",
x = "Time",
y = "Total Traffic (Mbps)") +
theme_minimal()
# Summarize data by Traffic Type
traffic_summary <- data_long %>%
group_by(TrafficType) %>%
summarise(TotalTraffic = sum(Traffic))
# Create Donut Chart
ggplot(traffic_summary, aes(x = 2, y = TotalTraffic, fill = TrafficType)) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") +
geom_text(aes(label = paste0(round((TotalTraffic / sum(TotalTraffic)) * 100), "%")),
position = position_stack(vjust = 0.5)) +
theme_void() +
xlim(0.5, 2.5) +
labs(title = "Donut Chart of Traffic Type Distribution") +
theme(legend.position = "right")
set.seed(123)
num_records <- 1000
timestamps <- seq.POSIXt(from = as.POSIXct("2024-06-03 00:00:00"),
by = "hour", length.out = num_records)
generate_ipv4 <- function(n) {
paste(sample(0:255, n, replace = TRUE), sample(0:255, n, replace = TRUE),
sample(0:255, n, replace = TRUE), sample(0:255, n, replace = TRUE), sep = ".")
}
source_ips <- generate_ipv4(num_records)
destination_ips <- generate_ipv4(num_records)
bytes_transferred <- sample(100:10000, num_records, replace = TRUE)
traffic_data <- data.frame(
timestamp = timestamps,
source_ip = source_ips,
destination_ip = destination_ips,
bytes_transferred = bytes_transferred
)
head(traffic_data)
options(repr.plot.width=10, repr.plot.height=6)
ggplot(traffic_data, aes(x = timestamp, y = bytes_transferred)) +
geom_line() +
labs(title = "Network Traffic Over Time",
x = "Timestamp",
y = "Bytes Transferred")
options(repr.plot.width=10, repr.plot.height=6)
ggplot(traffic_data, aes(x = timestamp, y = bytes_transferred)) +
geom_line() +
labs(title = "Network Traffic Over Time",
x = "Timestamp",
y = "Bytes Transferred")
library(ggplot2)
ggplot(traffic_data, aes(x = timestamp, y = bytes_transferred)) +
geom_line() +
labs(title = "Network Traffic Over Time",
x = "Timestamp",
y = "Bytes Transferred")
top_talkers <- aggregate(bytes_transferred ~ source_ip, data = traffic_data, FUN = sum)
top_talkers <- top_talkers[order(top_talkers$bytes_transferred, decreasing = TRUE), ]
top_talkers <- head(top_talkers, 10) # Selecting top 10 talkers for visualization
ggplot(top_talkers, aes(x = reorder(source_ip, bytes_transferred),
y = bytes_transferred, fill = bytes_transferred)) +
geom_bar(stat = "identity", color = "black") +
scale_fill_gradient(low = "lightblue", high = "blue") +
labs(title = "Top 10 Network Talkers",
x = "Source IP Address",
y = "Bytes Transferred") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
axis.title.x = element_text(size = 12, face = "bold"),
axis.title.y = element_text(size = 12, face = "bold"),
legend.position = "none") +
geom_text(aes(label = scales::comma(bytes_transferred)), vjust = -0.3, size = 3.5)
destination_summary <- aggregate(bytes_transferred ~ destination_ip, data = traffic_data,
FUN = sum)
destination_summary <- destination_summary[order(destination_summary$bytes_transferred,
decreasing = TRUE), ]
top_destinations <- head(destination_summary, 10)
ggplot(top_destinations, aes(x = bytes_transferred, y = reorder(destination_ip,
bytes_transferred))) +
geom_segment(aes(x = 0, xend = bytes_transferred, y = reorder(destination_ip,
bytes_transferred),
yend = reorder(destination_ip, bytes_transferred)),
color = "grey") +
geom_point(aes(color = bytes_transferred), size = 4) +
scale_color_gradient(low = "lightgreen", high = "darkgreen") +
labs(title = "Top 10 Network Destinations",
x = "Bytes Transferred",
y = "Destination IP Address") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
axis.title.x = element_text(size = 12, face = "bold"),
axis.title.y = element_text(size = 12, face = "bold"),
axis.text.y = element_text(size = 10),
legend.position = "none") +
geom_text(aes(label = scales::comma(bytes_transferred)), hjust = -0.1, size = 3.5)
set.seed(123)
num_records <- nrow(traffic_data)
traffic_data$source_latitude <- runif(n = num_records, min = -90, max = 90)
traffic_data$source_longitude <- runif(n = num_records, min = -180, max = 180)
traffic_data$destination_latitude <- runif(n = num_records, min = -90, max = 90)
traffic_data$destination_longitude <- runif(n = num_records, min = -180, max = 180)
leaflet(data = traffic_data) %>%
addTiles() %>%
addCircleMarkers(~source_longitude, ~source_latitude, radius = 5,
color = "blue", fillOpacity = 0.5,
label = ~paste("Source:", source_ip)) %>%
addCircleMarkers(~destination_longitude, ~destination_latitude, radius = 5,
color = "red", fillOpacity = 0.5, label = ~paste("Destination:",
destination_ip)) %>%
addPolylines(~c(source_longitude, destination_longitude), ~c(source_latitude,
destination_latitude),
color = "green", weight = 2, opacity = 0.7) %>%
addLegend("bottomright", colors = c("blue", "red", "green"),
labels = c("Source IP", "Destination IP", "Traffic Path"),
title = "Legend") %>%
setView(lng = mean(traffic_data$source_longitude),
lat = mean(traffic_data$source_latitude), zoom = 1)
set.seed(123)
num_records <- nrow(traffic_data)
traffic_data$source_latitude <- runif(n = num_records, min = -90, max = 90)
traffic_data$source_longitude <- runif(n = num_records, min = -180, max = 180)
traffic_data$destination_latitude <- runif(n = num_records, min = -90, max = 90)
traffic_data$destination_longitude <- runif(n = num_records, min = -180, max = 180)
leaflet(data = traffic_data) %>%
addTiles() %>%
addCircleMarkers(~source_longitude, ~source_latitude, radius = 5,
color = "blue", fillOpacity = 0.5,
label = ~paste("Source:", source_ip)) %>%
addCircleMarkers(~destination_longitude, ~destination_latitude, radius = 5,
color = "red", fillOpacity = 0.5, label = ~paste("Destination:",
destination_ip)) %>%
addPolylines(~c(source_longitude, destination_longitude), ~c(source_latitude,
destination_latitude),
color = "green", weight = 2, opacity = 0.7) %>%
addLegend("bottomright", colors = c("blue", "red", "green"),
labels = c("Source IP", "Destination IP", "Traffic Path"),
title = "Legend") %>%
setView(lng = mean(traffic_data$source_longitude),
lat = mean(traffic_data$source_latitude), zoom = 1)
library(leaflet)
set.seed(123)
num_records <- nrow(traffic_data)
traffic_data$source_latitude <- runif(n = num_records, min = -90, max = 90)
traffic_data$source_longitude <- runif(n = num_records, min = -180, max = 180)
traffic_data$destination_latitude <- runif(n = num_records, min = -90, max = 90)
traffic_data$destination_longitude <- runif(n = num_records, min = -180, max = 180)
leaflet(data = traffic_data) %>%
addTiles() %>%
addCircleMarkers(~source_longitude, ~source_latitude, radius = 5,
color = "blue", fillOpacity = 0.5,
label = ~paste("Source:", source_ip)) %>%
addCircleMarkers(~destination_longitude, ~destination_latitude, radius = 5,
color = "red", fillOpacity = 0.5, label = ~paste("Destination:",
destination_ip)) %>%
addPolylines(~c(source_longitude, destination_longitude), ~c(source_latitude,
destination_latitude),
color = "green", weight = 2, opacity = 0.7) %>%
addLegend("bottomright", colors = c("blue", "red", "green"),
labels = c("Source IP", "Destination IP", "Traffic Path"),
title = "Legend") %>%
setView(lng = mean(traffic_data$source_longitude),
lat = mean(traffic_data$source_latitude), zoom = 1)
setwd("E:/Shaan/R file/Regression")
setwd("E:/Shaan/R file/Dplyr")
install.packages("magrittr")
install.packages("dplyr")
library(magrittr)
library(dplyr)
df <- data.frame(
"employeeid" = c(1,2,3,4,5,6,7,8,9,10),
"employeename" = c("sameer","ravi","ankit","vijay","shaan","Aquib","Prtiksha","Archana","Vaishnavi","Amit"),
"salary" = c(56000,89000,45000,35000,90000,85000,96000,74000,67500,79500),
"department" = c("hr","sales","Mk","R&D","IT","hr","sales","Mk","R&D","IT"),
"branch" = c("Mumbai","Pune","Nasik","Delhi","Bangalore","Mumbai","Pune","Nasik","Delhi","Bangalore")
)
df
dplyr::select(df,employeeid)
dplyr::select(df,employeeid, employeename)
dplyr::select(df, -employeename)
dplyr::select(df,everything())
dplyr::select(df,contains("a"))
dplyr::select(df,contains("h"))
dplyr::select(df,contains("a"))
dplyr::select(df,starts_with("e"))
dplyr::select(df,ends_with("e"))
dplyr::select(df,matches("^e"))
dplyr::select(df,employeeid:salary)
df
dplyr::select(df,1:4)
dplyr::filter(df,salary>50000)
dplyr::filter(df,salary>50000,department == "hr")
dplyr::filter(df,salary>50000,department %in% c("hr","sales","IT"))
dplyr::mutate(df,annual_salary=salary*12, new_dep=department)
df
df <- dplyr::mutate(df,annual_salary=salary*12, new_dep=department)
df
dplyr::summarise(df,mymedian=median(salary),myfirst=first(salary),mymin=min(salary))
dplyr::summarise(df,mymedian=median(salary),myfirst=first(salary),mymin=min(salary) ,mysum=sum(salary))
df
dplyr::summarise(df,mymedian=median(salary),myfirst=first(salary),mymin=min(salary) ,mysum=sum(salary),mylast=last(salary))
new_df <- dplyr::summarise(df,mymedian=median(salary),myfirst=first(salary),mymin=min(salary) ,mysum=sum(salary),mylast=last(salary))
df
new_df
df
dplyr::arrange(df,salary)
dplyr::arrange(df,desc(salary))
df[,c("employeeid","employeename")]
df %>% select(employeeid,employeename)
df %>% select(employeeid, employeename,salary)
df %>% filter(salary>45000)
df %>% mutate(new_dept=department)
df %>% summarise(last=last(salary))
df %>% arrange(salary)
df %>% summarise(sum=sum(salary))
df %>% filter(department=="hr") %>% summarise(sum=sum(salary))
df %>% filter(department=="IT") %>% summarise(sum=sum(salary))
df %>% group_by(department)
df %>% group_by(department) %>%
summarise(sum=sum(salary))
df %>% group_by(branch) %>%
summarise(sum=sum(salary),min=min(salary))
df
df2 <- data.frame(
"gender"= c("male","male","male","male","male","male","Female","Female","Female","male")
)
df %>% bind_cols(df2)
df
df <- df %>% bind_cols(df2)
df
df2 <- data.frame(
"employeeid"=c(11,12),
"employeename"=c("ankita","sonal"),
"salary"=c(48000,51000),
"department"=c("IT","sales"),
"branch"=c("Mumbai","Bangalore")
)
df %>% bind_rows(df2)
df <- df %>% bind_rows(df2)
df
x <- data.frame(
"A"=c(1,2,3),
"B"=c("A","B","C")
)
y <- data.frame(
"A"=c(2,3,4),
"B"=c("B","C","D")
)
x %>% union(y)
y %>% union(x)
y %>% union(x)
x %>% union(y)
x %>% union(y)
y %>% union(x)
x %>% intersect(y)
x %>% setdiff(y)
y %>% setdiff(x)
movie <- data.frame(
"movie_id"=c(1,2,3,4),
"movie_name"=c("saalar","tiger3","pathan","War"),
"year_made"=c(2024,2024,2023,2019)
)
actor <- data.frame(
"movie_id"=c(1,2,3,5),
"first_name"=c("Prabhas","Salaman","Shahruk","Hrithik"),
"last_name"=c("Raju","Khan","Khan","Roshan")
)
movie
actor
library(dplyr)
x <- data.frame(
"A"=c(1,2,3),
"B"=c("A","B","C")
)
y <- data.frame(
"A"=c(2,3,4),
"B"=c("B","C","D")
)
x %>% union(y)
y %>% union(x)
x %>% union_all(y)
x %>% intersect(y)
x %>% setdiff(y)
y %>% setdiff(x)
movie <- data.frame(
"movie_id"=c(1,2,3,4),
"movie_name"=c("saalar","tiger3","pathan","War"),
"year_made"=c(2024,2024,2023,2019)
)
actor <- data.frame(
"movie_id"=c(1,2,3,5),
"first_name"=c("Prabhas","Salaman","Shahruk","Hrithik"),
"last_name"=c("Raju","Khan","Khan","Roshan")
)
movie
actor
movie
actor
movie
actor
movie %>% inner_join(actor)
movie %>% left_join(actor)
movie %>% right_join(actor)
movie %>% full_join(actor)
movie %>% full_join(dplyr::select(actor,movie_id,first_name))
actor <- dplyr::select(actor,-last_name)
actor
actor
new_df <-  dplyr::select(mutate(actor,fn=first_name),-first_name)
new_df
colnames(movie)
colnames(actor)
colnames(movie)[3]="year"
movie
colnames(movie)
df
dplyr::filter(df,!(employeeid %in% c(11,12)))
df
dplyr::mutate(actor,sr_no=rownames(actor))
rownames(actor)[2]=actor$fn
actor
rownames(actor)[1]="A"
actor
rownames(actor)[1:4]=letters[1:4]
actor
rownames(actor)[1:3]=31:33
actor
rownames(actor)[2]="Sunil"
actor
